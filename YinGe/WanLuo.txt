今日录屏
day1-1

day1-2

day1-3

无线:eagle-lab-5g或eagle-lab

密码:1357924680

数据网络
数据：媒体文件，文本文件，自定义的信息

存储介质：U盘，硬盘，信息化数据必须用二进制存储

编码：

ASCII		8位bit=1字节Byte    100Mb/s
unicode    32位
utf-8          24位
gbk            16位 
数据抓包：

将电脑从网口发出去的二进制全部复制一份，并且进行分析
数据报头:

为了更加方便的传递数据的状态，会在数据真实开始前加上一些控制信息，被称之为数据报头
通信过程
集线器
直接物理联通，数据完全共享，所有接口都在一个冲突域下

现已淘汰，买不到新的

交换机
让多台设备可以同时进行数据交换

交换机会根据数据前48位二进制所表示的MAC地址来判断目的地所在的接口，然后准确转发这个数据

所有的接口都在一个广播域下

 

路由器
image-20201107112231458

交换机负责组建局域网，路由器负责将多个局域网连接，形成广域网

路由器需要隔离广播，并且提供远距离目的地寻路

 

数据封装
为了让数据到达目的地，会在数据前面加上多层报头，每层报文头部都会包含所对应功能的信息。

应用层

	提供用户交互接口

表示层

	提供数据加解密，解压缩，格式化

会话层

	管理与维持会话

传输层

	提供数据的传输控制能力TCP/UDP

	提供应用区分能力port

网络层

	提供数据远程传输能力IP

数据链路层

	提供数据在局域网中传输能力MAC

	提供数据完整性验证

物理层

	提供数据传输介质的标准规范

 

数据链路层报头

image-20201107105818954

 

ARP地址解析协议
访问一个目的地IP地址的时候，不知道对方的MAC地址，就会发起广播查询。

如果目的地IP地址不是一个网段，如果没有网关，不会触发ARP
如果目的地IP地址不是一个网段，如果有网关，那么ARP的结果将会是网关的MAC地址
IP编址
IP由32位二进制组成，为了方便记忆，点分十进制，每8个二进制为一组，组之间用.分割，并且转为十进制

IP地址是由网络位和主机位组成

网络位相当于手机号码前7位作为手机号码归属地，网络位表示的是IP地址所属的局域网(LAN)
主机位表示主机在局域网中的编号，不能出现一样的
主机位不能全为0，主机位全为1表示广播
有类方式区分网络位长度

A：1.0.0.0~126.255.255.255       前8位是网络位   /8
B:   128.0.0.0~191.255.255.255    前16位是网络位   /16
C:   192.0.0.0~223.255.255.255    前24位是网络位   /24
127开头的所有IP地址用作本地保留
子网掩码用来自由的划分网络位长度，子网掩码也是32位二进制，可以和IP地址一一对应。

子网掩码位是1，表示IP地址对应的位就是网络位。

192.168.1.129/25
255.255.255.128
私有IP地址

A：10.0.0.0~10.255.255.255
B：172.16.0.0~172.31.255.255
C：192.168.0.0~192.168.255.255
Port端口号
用于区分同一个IP提供的不同服务
一个IP地址可以有216个端口号
其中有些端口号用处是大家约定好的，每个操作系统都会有一个文件用于存储这些常见的端口号。
C:\Windows\System32\drivers\etc\services
常用端口号
http:80

https:443

ftp:21/20

telnet:23

ssh:22

rdp:3389

vnc:5900

mysql:3306

服务器上面提供服务的端口是长期开启的，客户端上的端口号是随机找一个大于1024的空闲端口，用于接收数据。

 

网络常用工具
ping <目的地址>
# 用于检查到目的地址的连通性
tracert <目的地址>
# 用于检查到目的地址的每一跳
nslookup <网址>
# 用于查询网址对应的IP地址
netstat -ano |findstr <你想看的内容>
# 用于查询端口号与进程号的对应关系
TCP序列号与确认号
image-20200614110231593

TCP三次握手
image-20200614110302192

TCP四次挥手
image-20200614110317671

TCP滑动窗口
看我博客去

TCP有限状态机
看我博客去

报文格式
image-20200614111802447

image-20200614111807452






















 今日内容扩展
访问控制列表

DHCP

NAT与DNS

今日录屏
day2-1

day2-2

day2-3

回顾
计算机软件产生用户数据

数据需要加上传输层报头，报头中包含端口号(用于关联进程)

传输层报头之外，再加上网络层报头，报头中有IP地址(用于远距离传输)

网络层报头之外，再加上数据链路层报头，报头中有MAC地址(用于交接下一跳)

数据链路层处理完毕之后，就会编码为二进制，然后通过网卡发出

接受方收到数据，查看MAC地址

不是自己，如果是交换机就转发，如果是其他设备就忽略
是自己，拆开数据链路层报头
查看网络层IP地址

不是自己，如果是路由器就转发，如果是其他设备就忽略
是自己，就拆开网络层报头
查看端口号

端口号监听状态，交给对应的进程
不是监听状态，防火墙拦截，或者忽略
ARP
知道对方的IP地址，不知道对方的MAC地址，发起局域网广播(即目的MAC地址为ffff-ffff-ffff)
代理ARP就是访问远程IP地址的时候，网关代替目的地进行ARP回应
思科路由器IP配置
no     # 取消配置向导
enable      # 进入特权模式
config terminal     # 进入全局配置模式
interface e0/0      # 进入接口配置模式
ip address 192.168.1.1 255.255.255.0    # 配置IP地址
no shutdown         # 删除接口的shutdown命令
exit                # 退出当前模式
end                 # 直接回到特权模式
write               # 保存配置
传输层
传输层提供数据的传输方式，目前最常见的是TCP/UDP
TCP提供可靠的数据传输
UDP提供尽力而为的数据传输
TCP序列号与确认号
image-20200614110231593

TCP三次握手
image-20200614110302192

TCP四次挥手
image-20200614110317671

TCP滑动窗口
看我博客去

TCP有限状态机
看我博客去

报文格式
image-20200614111802447

image-20200614111807452

访问控制列表
ACL(access control list)，主要用来匹配流量

标准访问控制列表

主要用于对IP地址进行识别和过滤
扩展访问控制列表

主要针对应用做过滤
标准访问控制列表
image-20201108134622875

在win1上搭建web服务在80端口
确保win2可以正常访问win1的网页
在路由器上配置访问控制列表，让来自于192.168.2.2的流量无法穿过路由器
access-list <编号> <permit/deny> <IP地址> /<网络位长度>
access-list <编号> <permit/deny> <IP地址> /<网络位长度>
access-list <编号> <permit/deny> <IP地址> /<网络位长度>
access-list <编号> <permit/deny> <IP地址> /<网络位长度>
默认情况下，访问控制列表没有匹配上的流量默认是deny
acl的IP地址可以用any表示匹配任意
acl同一个编号下可以写多个规则，安装顺序匹配，一旦匹配上就执行动作
标准访问控制列表只能匹配流量中源IP地址
Router(config)#access-list 1 deny 192.168.2.2 /32
// 匹配192.168.2.2/32条目，动作是拒绝
Router(config)#access-list 1 permit any
// 放行所有
Router(config)#int e0/0
Router(config-if)#ip access-group 1 out
// 将访问控制列表1配置在这个接口的out方向
扩展访问控制列表
让win1的网站可以被访问，但是不允许被ping通
access-list 100 deny icmp any host 192.168.1.2 echo
// 拒绝目的地是192.168.1.2的ping请求
access-list 100 permit ip any any
// 放行所有
interface Ethernet0/1
 ip access-group 100 in
 
access-list 100 deny tcp any host 192.168.1.2 eq 80
// 过滤tcp的端口号80
access-list 100 permit ip any any
网络地址转换
现有IPv4地址早就被分配光，企业或者学校内部网络都是使用私有IP地址构建
NAT(network address translate)，核心功能就是将流量中私有IP地址替换为公有IP地址，从而可以与外网通信
NAT优缺点
优点	缺点
节省IP地址空间	增加转发延迟
解决IP地址重叠问题	丧失端到端的寻址能力
增加网络的连入Internet的弹性	某些应用不支持NAT
网络变更的时候减少IP重编址带来的麻烦	需要一定的内存空间支持动态存储NAT表项
对外隐藏内部地址，增加网络安全性	需要耗费一定CPU内存资源进行NAT操作
NAT术语
术语	英文	解释
内部本地	inside local	转换之前源地址
外部本地	outside local	转换之前目的地址
内部全局	inside global	转换之后源地址
内部全局	outside global	转换之后目的地址
inside表示源地址，outside表示目的地址
local表示转换之前，global表示转换之后
image-20201108143757450

no
en
conf t
int e0/0
ip add dhcp
no sh
ip nat outside
int e0/1
ip add 192.168.1.1 255.255.255.0
no sh
ip nat inside
access-list 1 permit 192.168.1.0 /24
ip nat inside source list 1 interface e0/0 overload
do show ip int br
DNS
DNS(Domain name System)，域名系统，用于查询域名对应的IP地址的
114.114.114.114 114.114.115.115
Router(config)#ip dns server
Router(config)#ip host test.com 192.168.1.103
DHCP
DHCP(Dynamic Host Configuration Protocol)，动态主机配置协议，主要用于给设备分配IP地址相关信息

自动发放的信息

IP地址
子网掩码
默认网关
主备DNS
租约时间
ip dhcp pool sale
 network 192.168.1.0 /24
 default-route 192.168.1.1
 dns-server 192.168.1.1 114.114.114.114
 lease 0 0 2
ip dhcp excluded-address 192.168.1.1 192.168.1.99
DHCP的续租

当租约时间0.5的时候，就会单播向dhcp服务器发起续租请求
如果续租没有得到回应，当租约时间0.875的时候，就会广播向整个局域网发起续租请求
如果续租没有得到回应，当租约时间到的时候，就会放弃这个IP地址，并且以0.0.0.0发送dhcp的discover消息